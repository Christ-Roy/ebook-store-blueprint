<IfModule mod_rewrite.c>
  RewriteEngine On
  RewriteBase /git-deploy/
  
  # Utiliser js-loader.php comme point d'entrée principal
  DirectoryIndex js-loader.php index.html
  
  # Rediriger les requêtes .js vers le proxy PHP
  RewriteRule ^(.+)\.js$ js-proxy.php?file=$1.js [L,QSA]
  
  # Gérer les routes SPA pour React
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME} !-l
  RewriteRule . /git-deploy/js-loader.php [L]
</IfModule>

# Configuration des types MIME (solution de secours)
<IfModule mod_mime.c>
  AddType application/javascript .js
  AddType application/javascript .js.txt
  AddType application/javascript .txt
  AddType text/css .css
</IfModule>

<IfModule mod_headers.c>
  <FilesMatch "\.(js|mjs|js\.txt|mjs\.txt|txt)$">
    Header set Content-Type "application/javascript"
  </FilesMatch>
</IfModule>